{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de M√°quinas Expendedoras</title>
    <link rel="stylesheet" href="{% static 'index.css' %}">
</head>
<body>
    <div class="main-container">
        <!-- Header con logo -->
        <div class="header">
            <div class="logo-section">
                <img src="{% static 'logo.png' %}" alt="Logo" class="logo">
                <div class="title-section">
                    <h1>üîÑ Gesti√≥n de M√°quinas Expendedoras</h1>
                    <p>Sistema integral para la administraci√≥n de inventario y recargas</p>
                </div>
            </div>
            <div class="user-section">
                <span class="user-name">üë§ {{ request.session.user_name }}</span>
                <a href="{% url 'logout' %}" class="logout-btn">
                    <span>üö™</span>
                    <span>Cerrar Sesi√≥n</span>
                </a>
            </div>
        </div>

        <!-- Contenido principal -->
        <div class="content">
            <div class="actions-grid">
                <div class="action-card">
                    <div class="action-icon">üõí</div>
                    <a href="{% url 'registrarCompra' %}" class="action-btn">
                        <span>Registrar Compra</span>
                        <span class="arrow">‚Üí</span>
                    </a>
                </div>

                <div class="action-card">
                    <div class="action-icon">üìä</div>
                    <a href="{% url 'actualizarStock' %}" class="action-btn">
                        <span>Cargar Maquina</span>
                        <span class="arrow">‚Üí</span>
                    </a>
                </div>
            </div>

                <div class="action-card">
                    <div class="action-icon">üöõ</div>
                    <a href="{% url 'consultarStock' %}" class="action-btn">
                        <span>Consultar Stock en Deposito</span>
                        <span class="arrow">‚Üí</span>
                    </a>
                </div>
            </div>

            <div style="text-align:center; margin: 20px 0;">
                <button type="button" id="btnVerProveedores" class="action-btn" style="display:inline-flex; align-items:center; gap:8px; padding:10px 16px;">
                    <span>üë• Ver proveedores</span>
                </button>
                <button type="button" id="btnVerMaquinas" class="action-btn" style="display:inline-flex; align-items:center; gap:8px; padding:10px 16px; margin-left:12px;">
                    <span>üè≠ Ver m√°quinas</span>
                </button>
            </div>

            

            <div class="info-section">
                <h5>Flash 24 Vending. Todos los derechos reservados</h5>
            </div>
        </div>
    </div>

    <!-- Modal Proveedores -->
    <div id="modalProveedores" class="modal-overlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.45); justify-content:center; align-items:center; z-index:1000;">
        <div class="modal-content" style="background:#fff; padding:20px; border-radius:10px; width:90%; max-width:720px; max-height:80vh; overflow:auto; box-shadow:0 10px 30px rgba(0,0,0,0.15);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <h2 style="margin:0;">Proveedores</h2>
                <button type="button" id="btnCerrarProveedores" style="border:none; background:#eee; padding:6px 10px; border-radius:6px; cursor:pointer;">Cerrar</button>
            </div>
            <table style="width:100%; border-collapse:collapse;">
                <thead>
                    <tr style="background:#f5f5f5; text-align:left;">
                        <th style="padding:8px; border-bottom:1px solid #ddd;">Nombre</th>
                        <th style="padding:8px; border-bottom:1px solid #ddd;">Tel√©fono</th>
                        <th style="padding:8px; border-bottom:1px solid #ddd;">Email</th>
                    </tr>
                </thead>
                <tbody>
                    {% if proveedores %}
                        {% for prov in proveedores %}
                        <tr>
                            <td style="padding:8px; border-bottom:1px solid #eee;">{{ prov.nombre }}</td>
                            <td style="padding:8px; border-bottom:1px solid #eee;">{{ prov.telefono }}</td>
                            <td style="padding:8px; border-bottom:1px solid #eee;">{{ prov.email }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr><td colspan="3" style="padding:12px; text-align:center;">Sin proveedores cargados</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal Maquinas -->
    <div id="modalMaquinas" class="modal-overlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.45); justify-content:center; align-items:center; z-index:1000;">
        <div class="modal-content" style="background:#fff; padding:20px; border-radius:10px; width:90%; max-width:720px; max-height:80vh; overflow:auto; box-shadow:0 10px 30px rgba(0,0,0,0.15);">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                <h2 style="margin:0;">M√°quinas</h2>
                <button type="button" id="btnCerrarMaquinas" style="border:none; background:#eee; padding:6px 10px; border-radius:6px; cursor:pointer;">Cerrar</button>
            </div>
            <table style="width:100%; border-collapse:collapse;">
                <thead>
                    <tr style="background:#f5f5f5; text-align:left;">
                        <th style="padding:8px; border-bottom:1px solid #ddd;">Nombre</th>
                        <th style="padding:8px; border-bottom:1px solid #ddd;">Ubicaci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    {% if maquinas %}
                        {% for maq in maquinas %}
                        <tr>
                            <td style="padding:8px; border-bottom:1px solid #eee;">{{ maq.nombre }}</td>
                            <td style="padding:8px; border-bottom:1px solid #eee;">{{ maq.ubicacion }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr><td colspan="2" style="padding:12px; text-align:center;">Sin m√°quinas cargadas</td></tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <script>
        (function(){
            const modal = document.getElementById('modalProveedores');
            const btnOpen = document.getElementById('btnVerProveedores');
            const btnClose = document.getElementById('btnCerrarProveedores');

            function abrir() { modal.style.display = 'flex'; }
            function cerrar() { modal.style.display = 'none'; }

            if (btnOpen) btnOpen.addEventListener('click', abrir);
            if (btnClose) btnClose.addEventListener('click', cerrar);
            if (modal) {
                modal.addEventListener('click', (e) => { if (e.target === modal) cerrar(); });
                document.addEventListener('keydown', (e) => { if (e.key === 'Escape') cerrar(); });
            }
        })();

        (function(){
            const modal = document.getElementById('modalMaquinas');
            const btnOpen = document.getElementById('btnVerMaquinas');
            const btnClose = document.getElementById('btnCerrarMaquinas');

            function abrir() { modal.style.display = 'flex'; }
            function cerrar() { modal.style.display = 'none'; }

            if (btnOpen) btnOpen.addEventListener('click', abrir);
            if (btnClose) btnClose.addEventListener('click', cerrar);
            if (modal) {
                modal.addEventListener('click', (e) => { if (e.target === modal) cerrar(); });
                document.addEventListener('keydown', (e) => { if (e.key === 'Escape') cerrar(); });
            }
        })();
    </script>
</body>
</html>
